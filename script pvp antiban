local a=game:GetService("Players")local b=game:GetService("RunService")local c=a.LocalPlayer local d=workspace.CurrentCamera local e="SafeTinyHealthBar"local f=c:FindFirstChild("PlayerGui"):FindFirstChild(e)if f then f:Destroy()end local g=Instance.new("ScreenGui")g.Name=e g.ResetOnSpawn=false g.ZIndexBehavior=Enum.ZIndexBehavior.Sibling g.Parent=c:WaitForChild("PlayerGui")local h={}local i={}local j=60 local k=65 local function l()for m,n in ipairs(a:GetPlayers())do if n~=c then if h[n]then pcall(function()h[n]:Destroy()end)h[n]=nil end if i[n]then for o,p in ipairs(i[n])do pcall(function()p:Disconnect()end)end i[n]=nil end if n.Character then task.spawn(function()q(n)end)end end end end local function q(r)if r==c then return end if h[r]then pcall(function()h[r]:Destroy()h[r]=nil end)end if i[r]then for s,t in ipairs(i[r])do pcall(function()t:Disconnect()end)end i[r]=nil end local function u(v)if not v then return end local w=v:WaitForChild("HumanoidRootPart",10)local x=v:WaitForChild("Head",10)local y=v:WaitForChild("Humanoid",10)if not w or not x or not y then return end if h[r]then pcall(function()h[r]:Destroy()end)end local z=Instance.new("BillboardGui")z.Name="SafeHealth_"..r.Name z.Adornee=x z.AlwaysOnTop=true z.LightInfluence=0 z.Size=UDim2.new(0,180,0,40)z.StudsOffset=Vector3.new(0,3.2,0)z.Enabled=false z.ResetOnSpawn=false z.Parent=g local A=Instance.new("Frame",z)A.Size=UDim2.new(1,0,1,0)A.BackgroundColor3=Color3.fromRGB(22,22,32)A.BackgroundTransparency=0.3 A.BorderSizePixel=0 local B=Instance.new("UICorner",A)B.CornerRadius=UDim.new(0,10)local C=Instance.new("UIStroke",A)C.Color=Color3.fromRGB(100,200,255)C.Thickness=2 C.Transparency=0.3 local D=Instance.new("Frame",A)D.Size=UDim2.new(0.94,0,0.4,0)D.Position=UDim2.new(0.03,0,0.35,0)D.BackgroundColor3=Color3.fromRGB(40,40,50)D.BorderSizePixel=0 local E=Instance.new("UICorner",D)E.CornerRadius=UDim.new(0,6)local F=Instance.new("Frame",D)F.Size=UDim2.new(1,0,1,0)F.BackgroundColor3=Color3.fromRGB(0,255,100)F.BorderSizePixel=0 local G=Instance.new("UICorner",F)G.CornerRadius=UDim.new(0,6)local H=Instance.new("TextLabel",A)H.Size=UDim2.new(0.94,0,0.5,0)H.Position=UDim2.new(0.03,0,0.02,0)H.BackgroundTransparency=1 H.TextColor3=Color3.new(1,1,1)H.TextScaled=true H.Font=Enum.Font.GothamBlack H.TextStrokeTransparency=0.2 H.TextStrokeColor3=Color3.new(0,0,0)H.Text="100.0 / 100.0"local I=Instance.new("TextLabel",A)I.Size=UDim2.new(0.5,0,0.2,0)I.Position=UDim2.new(0.03,0,0.85,0)I.BackgroundTransparency=1 I.TextColor3=Color3.fromRGB(200,200,255)I.TextScaled=true I.Font=Enum.Font.Gotham I.TextStrokeTransparency=0.5 I.Text=r.Name I.TextXAlignment=Enum.TextXAlignment.Left h[r]=z local function J()if not y or not y.Parent then return end local K=y.Health local L=y.MaxHealth if K<=0 then H.Text="0.0 / 0.0"F.Size=UDim2.new(0,0,1,0)F.BackgroundColor3=Color3.fromRGB(255,50,50)F.BackgroundTransparency=0 else H.Text=string.format("%.1f / %.1f",K,L)local M=math.clamp(K/L,0,1)F.Size=UDim2.new(M,0,1,0)if M>0.6 then F.BackgroundColor3=Color3.fromRGB(0,255,100)elseif M>0.3 then F.BackgroundColor3=Color3.fromRGB(255,200,0)else F.BackgroundColor3=Color3.fromRGB(255,100,0)F.BackgroundTransparency=0.2+0.2*math.sin(tick()*10)end end end local N={y:GetPropertyChangedSignal("Health"):Connect(J),y:GetPropertyChangedSignal("MaxHealth"):Connect(J),y.Died:Connect(function()H.Text="0.0 / 0.0"F.Size=UDim2.new(0,0,1,0)F.BackgroundColor3=Color3.fromRGB(255,0,0)end)}i[r]=N J()end if r.Character then task.spawn(u,r.Character)else task.spawn(function()local O=0 while not r.Character and O<50 do task.wait(0.1)O=O+1 end if r.Character then u(r.Character)end end)end local P P=r.CharacterAdded:Connect(function(Q)if h[r]then pcall(function()h[r]:Destroy()end)h[r]=nil end if i[r]then for R,S in ipairs(i[r])do pcall(function()S:Disconnect()end)end i[r]=nil end task.wait(0.3)u(Q)end)if not i.char then i.char={}end i.char[r]=P end for T,U in ipairs(a:GetPlayers())do if U~=c then task.spawn(q,U)end end a.PlayerAdded:Connect(function(V)if V~=c then task.wait(0.2)task.spawn(q,V)end end)a.PlayerRemoving:Connect(function(W)if h[W]then pcall(function()h[W]:Destroy()end)h[W]=nil end if i[W]then for X,Y in ipairs(i[W])do pcall(function()Y:Disconnect()end)end i[W]=nil end if i.char and i.char[W]then pcall(function()i.char[W]:Disconnect()end)i.char[W]=nil end end)local function Z()local AA=c:FindFirstChild("PlayerGui")if AA and g.Parent~=AA then g.Parent=AA end task.wait(0.5)l()end c.CharacterAdded:Connect(Z)local AB=0 b.RenderStepped:Connect(function()AB=AB+1 if AB%2~=0 then return end local AC=0 local AD=0 for AE,AF in pairs(h)do AD=AD+1 if AF and AF.Parent and AE then if AE.Character then local AG=AE.Character:FindFirstChild("HumanoidRootPart")local AH=AE.Character:FindFirstChild("Head")if AG and AH then if AF.Adornee~=AH then AF.Adornee=AH end local AI=(d.CFrame.Position-AG.Position).Magnitude if AI<=j then if not AF.Enabled then AF.Enabled=true AC=AC+1 else AC=AC+1 end elseif AI>k then if AF.Enabled then AF.Enabled=false end end else if AF.Enabled then AF.Enabled=false end end else if AF.Enabled then AF.Enabled=false end end else h[AE]=nil end end if AB%300==0 then end end)task.wait(0.5)pcall(function()game:GetService("StarterGui"):SetCoreGuiEnabled(Enum.CoreGuiType.Health,false)end)task.spawn(function()while true do task.wait(30)for AJ,AK in ipairs(a:GetPlayers())do if AK~=c and AK.Character and not h[AK]then task.spawn(q,AK)end end end end)
